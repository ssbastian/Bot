

intents:
  - int_despedirse
  - int_si_despedida
  - int_no_despedida
  - int_respuesta_escuesta

entities:
  - ent_mejora
  - ent_satisfaccion
  - ent_recomendacion

slots:


  slot_feedback_pendiente:
    type: bool
    initial_value: false
    mappings:
      - type: custom   # ya no se llena automÃ¡ticamente por intents

  
  slot_ultima_encuesta:
    type: float   # usaremos timestamp (segundos desde epoch)
    influence_conversation: true
    mappings:
      - type: custom

  slot_mejora:
    type: text
    mappings:
      - type: from_entity
        entity: ent_mejora
        intent: int_respuesta_escuesta


  slot_satisfaccion:
    type: text
    mappings:
      - type: from_entity
        entity: ent_satisfaccion
        intent: int_respuesta_escuesta
        

  slot_recomendacion:
    type: text
    mappings:
      - type: from_entity
        entity: ent_recomendacion
        intent: int_respuesta_escuesta


responses:
  utter_ofrecer_feedback:
    - text: "ğŸ“ŠğŸ“ {slot_name} antes de irte, Â¿te gustarÃ­a responder 3 preguntas rÃ¡pidas sobre tu experiencia? (sÃ­/no)"
      buttons:
        - title: "âœ… SÃ­, dar feedback"
          payload: "/int_si_despedida"
        - title: "âŒ No, gracias"
          payload: "/int_no_despedida"

  utter_pregunta_1:
    - text: "â¡ï¸ Â¿Te sentiste mejor despues de la interacciÃ³n con el bot?"
      buttons:
      - title: "SÃ­ âœ…"
        payload: '/int_respuesta_escuesta{{"ent_mejora":"si"}}'
      - title: "No âŒ"
        payload: '/int_respuesta_escuesta{{"ent_mejora":"no"}}'

  utter_pregunta_2:
    - text: "â¡ï¸ Del 1 al 5, Â¿cÃ³mo calificarÃ­as tu experiencia? (1: Mala, 5: Excelente)"
      buttons:
      - title: "1 â­"
        payload: '/int_respuesta_escuesta{{"ent_satisfaccion": "1"}}'
      - title: "2 â­"
        payload: '/int_respuesta_escuesta{{"ent_satisfaccion": "2"}}'
      - title: "3 â­"
        payload: '/int_respuesta_escuesta{{"ent_satisfaccion": "3"}}'
      - title: "4 â­"
        payload: '/int_respuesta_escuesta{{"ent_satisfaccion": "4"}}'
      - title: "5 â­"
        payload: '/int_respuesta_escuesta{{"ent_satisfaccion": "5"}}'
  
  utter_pregunta_3:
    - text: "â¡ï¸ Â¿RecomendarÃ­as este bot a alguien mÃ¡s?"
      buttons:
        - title: "SÃ­ âœ…"
          payload: '/int_respuesta_escuesta{{"ent_recomendacion": "si"}}'
        - title: "No âŒ"
          payload: '/int_respuesta_escuesta{{"ent_recomendacion": "no"}}'
  
  utter_agradecimiento:
    - text: "Â¡Gracias por tu feedback! ğŸ’™"
  utter_bot_se_despide:
    - text: "Â¡Hasta luego! CuÃ­date mucho."

actions:
  - action_deactivate_feedback
  - action_verificar_feedback

